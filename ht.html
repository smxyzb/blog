<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <style>
            .wrap {
                width: 200px;
                border: 1px solid #333;
            }
            .wrap:after {
                content: '';
                display: block;
                clear: both;
            }
            .left {
                float: left;
                background: blue;
                height: 100px;
                width: 100px;
            }
            .right {
                float: left;
                background: red;
                height: 50px;
                width: 100px;
            }
            .center {
                height: 100px;
                width: 100px;
                position: absolute;
                left: 0;
                top: 0;
                right: 0;
                bottom: 0;
                margin: auto;
                background: green;
            }
            .center2 {
                position: absolute;
                top: 50%;
                left: 50%;
                margin: 0;
                transform: translateX(-50%) translateY(-50%);
                background: yellow;
            }
        </style>
    </head>

    <body>
    <header>
        <h2>Web APIs<h2>
    </header>
    <div class="web-api-cnt">
        <div class="web-api-card">
            <div class="web-api-card-head"> Demo - MessageChannel </div>
            <div class="web-api-card-body">
                <div id="error" class="close"></div>
                <div id="displayMsg">
                </div>
                <div>
                    <input id="input" type="text" placeholder="Send message to iframe" />
                </div>
                <div>
                    <button onclick="sendMsg()">Send Msg</button>
                </div>
                <div>
                    <iframe id="iframe" src="./content.html"></iframe>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    try {
        var channel = new MessageChannel()
        var port1 = channel.port1
    } catch (e) {
        error.innerHTML = "MessageChannel API not supported in this device."
        error.classList.remove("close")
    }

    iframe.addEventListener("load", onLoad)

    function onLoad() {
        port1.onmessage = onMessage
        iframe.contentWindow.postMessage("load", '*', [channel.port2])
    }

    function onMessage(e) {
        const newHTML = "<div>" + e.data + "</div>"
        displayMsg.innerHTML = displayMsg.innerHTML + newHTML
    }

    function sendMsg() {
        port1.postMessage(input.value)
    }

    

</script>

</html>
